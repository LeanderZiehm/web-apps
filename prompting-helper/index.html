<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LLM Prompt Workspace</title>
<link rel="stylesheet" href="./index.css" >
</head>
<body>
  <header>
    <h1 data-i18n="headerTitle"></h1>
    <div>
      <select id="langSwitch">
        <option value="de" selected>Deutsch</option>
        <option value="en">English</option>
    
      </select>
    </div>
  </header>

  <main>
    <section>
      <div class="section role">
        <h2 data-i18n="roleTitle"></h2>
        <span class="badge" data-i18n="badgeAuthority"></span>
        <p class="hint" data-i18n="roleHint"></p>
        <textarea id="role" data-i18n-placeholder="rolePlaceholder"></textarea>
      </div>

      <div class="section task">
        <h2 data-i18n="taskTitle"></h2>
        <span class="badge" data-i18n="badgeAction"></span>
        <p class="hint" data-i18n="taskHint"></p>
        <textarea id="task" data-i18n-placeholder="taskPlaceholder"></textarea>
      </div>

      <div class="section context">
        <h2 data-i18n="contextTitle"></h2>
        <span class="badge" data-i18n="badgeData"></span>
        <p class="hint" data-i18n="contextHint"></p>
        <textarea id="context" data-i18n-placeholder="contextPlaceholder"></textarea>
      </div>

      <div class="section constraints">
        <h2 data-i18n="constraintsTitle"></h2>
        <span class="badge" data-i18n="badgeGuardrails"></span>
        <p class="hint" data-i18n="constraintsHint"></p>
        <textarea id="constraints" data-i18n-placeholder="constraintsPlaceholder"></textarea>
      </div>

      <div class="section output">
        <h2 data-i18n="outputTitle"></h2>
        <span class="badge" data-i18n="badgeStructure"></span>
        <p class="hint" data-i18n="outputHint"></p>
        <textarea id="output" data-i18n-placeholder="outputPlaceholder"></textarea>
      </div>

      <div class="section examples">
        <h2 data-i18n="examplesTitle"></h2>
        <span class="badge" data-i18n="badgeCalibration"></span>
        <p class="hint" data-i18n="examplesHint"></p>
        <textarea id="examples" data-i18n-placeholder="examplesPlaceholder"></textarea>
      </div>
    </section>

    <aside>
      <h3 data-i18n="qualityTitle"></h3>
      <div id="signals"></div>
      <div class="score">
        <strong data-i18n="scoreLabel"></strong>
        <span id="score">0%</span>
      </div>

      <pre id="finalPrompt"></pre>

      <div class="prompt-meta">
        <input type="text" id="promptName" data-i18n-placeholder="promptNamePlaceholder">
        <input type="text" id="promptDesc" data-i18n-placeholder="promptDescPlaceholder">
      </div>

      <button id="newPromptBtn" data-i18n="newPromptBtn"></button>
      <button id="savePromptBtn" data-i18n="saveBtn"></button>

      <div class="prompt-list" id="promptList"></div>
    </aside>
  </main>

<script>
const fields = ["role","task","context","constraints","output","examples"];
const signalsEl = document.getElementById("signals");
const scoreEl = document.getElementById("score");
const finalPromptEl = document.getElementById("finalPrompt");
const langSwitch = document.getElementById("langSwitch");

const i18n = {
  en: {
    headerTitle: "Prompt Engineering Workspace",
    roleTitle: "Role / Persona",
    taskTitle: "Task / Objective",
    contextTitle: "Context / Input",
    constraintsTitle: "Constraints / Rules",
    outputTitle: "Output Format",
    examplesTitle: "Examples (Optional)",
    qualityTitle: "Prompt Quality & Live Preview",

    roleHint: "Define who the model is and its expertise.",
    taskHint: "Specify exactly what the model must do.",
    contextHint: "Provide domain context, constraints, or reference material.",
    constraintsHint: "What must or must not be done.",
    outputHint: "Define the response structure explicitly.",
    examplesHint: "Few-shot examples improve accuracy.",

    badgeAuthority: "Authority",
    badgeAction: "Action",
    badgeData: "Data",
    badgeGuardrails: "Guardrails",
    badgeStructure: "Structure",
    badgeCalibration: "Calibration",

    rolePlaceholder: "You are a senior backend engineer specializing in Spring Boot.",
    taskPlaceholder: "Design a REST API architecture for a multi-tenant SaaS app.",
    contextPlaceholder: "Enterprise customers, PostgreSQL, horizontal scaling.",
    constraintsPlaceholder: "Avoid vendor lock-in. Prefer clean architecture.",
    outputPlaceholder: "Return a layered architecture and sequence description.",
    examplesPlaceholder: "Input: ... Output: ...",

    promptNamePlaceholder: "Prompt name",
    promptDescPlaceholder: "Description",

    scoreLabel: "Prompt Quality Score:",
    saveBtn: "Save Prompt",
    newPromptBtn: "New Prompt",

    signalMissing: "is missing (critical)",
    signalOutputWarn: "Output format could be more explicit",
    signalGood: "Prompt structure looks strong",
    unsavedConfirm: "You have unsaved changes. Continue and lose changes?"
  },

  de: {
    headerTitle: "Prompt-Arbeitsbereich",
    roleTitle: "Rolle / Persona",
    taskTitle: "Aufgabe / Ziel",
    contextTitle: "Kontext / Eingabe",
    constraintsTitle: "EinschrÃ¤nkungen / Regeln",
    outputTitle: "Ausgabeformat",
    examplesTitle: "Beispiele (Optional)",
    qualityTitle: "Prompt-QualitÃ¤t & Live-Vorschau",

    roleHint: "Definiert, wer das Modell ist und welche Expertise es besitzt.",
    taskHint: "Gibt exakt an, was das Modell tun soll.",
    contextHint: "DomÃ¤nenkontext, EinschrÃ¤nkungen oder Referenzen.",
    constraintsHint: "Was erlaubt oder verboten ist.",
    outputHint: "Definiert die Struktur der Antwort eindeutig.",
    examplesHint: "Few-shot-Beispiele erhÃ¶hen die Genauigkeit.",

    badgeAuthority: "AutoritÃ¤t",
    badgeAction: "Aktion",
    badgeData: "Daten",
    badgeGuardrails: "Leitplanken",
    badgeStructure: "Struktur",
    badgeCalibration: "Kalibrierung",

    rolePlaceholder: "Du bist ein erfahrener Backend-Entwickler mit Fokus auf Spring Boot.",
    taskPlaceholder: "Entwirf eine REST-API fÃ¼r eine Multi-Tenant-SaaS-Anwendung.",
    contextPlaceholder: "Enterprise-Kunden, PostgreSQL, horizontale Skalierung.",
    constraintsPlaceholder: "Vendor Lock-in vermeiden. Clean Architecture bevorzugen.",
    outputPlaceholder: "Schichtenmodell und Sequenzbeschreibung liefern.",
    examplesPlaceholder: "Eingabe: ... Ausgabe: ...",

    promptNamePlaceholder: "Prompt-Name",
    promptDescPlaceholder: "Beschreibung",

    scoreLabel: "Prompt-QualitÃ¤tswert:",
    saveBtn: "Prompt speichern",
    newPromptBtn: "Neuer Prompt",

    signalMissing: "fehlt (kritisch)",
    signalOutputWarn: "Ausgabeformat kÃ¶nnte expliziter sein",
    signalGood: "Prompt-Struktur ist solide",
    unsavedConfirm: "Ungespeicherte Ã„nderungen gehen verloren. Fortfahren?"
  }
};

function applyLanguage(lang) {
  document.querySelectorAll("[data-i18n]").forEach(el => {
    el.textContent = i18n[lang][el.dataset.i18n];
  });

  document.querySelectorAll("[data-i18n-placeholder]").forEach(el => {
    el.placeholder = i18n[lang][el.dataset.i18nPlaceholder];
  });
}

function updatePreview() {
  const lang = langSwitch.value;
  let filled = 0;
  let signals = [];
  let outputText = "";

  fields.forEach(id => {
    const value = document.getElementById(id).value.trim();
    if (value) filled++;
    if ((id === "role" || id === "task") && !value) {
      signals.push(`â€¢ ${id.toUpperCase()} ${i18n[lang].signalMissing}`);
    }
    if (id === "output" && !value.toLowerCase().includes("format")) {
      signals.push(`â€¢ ${i18n[lang].signalOutputWarn}`);
    }
    if (value) outputText += `${id.toUpperCase()}:\n${value}\n\n`;
  });

  if (!signals.length) signals.push(`â€¢ ${i18n[lang].signalGood}`);

  signalsEl.innerHTML = signals.map(s => `<div>${s}</div>`).join("");
  scoreEl.textContent = Math.round((filled / fields.length) * 100) + "%";
  finalPromptEl.textContent = outputText.trim();
}

langSwitch.addEventListener("change", () => {
  applyLanguage(langSwitch.value);
  updatePreview();
});

applyLanguage("de");


const promptListEl = document.getElementById("promptList");
const nameInput = document.getElementById("promptName");
const descInput = document.getElementById("promptDesc");

let selectedPromptId = null;
let unsavedChanges = false;


// LocalStorage multiple prompts
function loadPrompts(){
  const data=JSON.parse(localStorage.getItem("prompts")||"{}");
  promptListEl.innerHTML="";
  for(const id in data){
    const p=data[id];
    const div=document.createElement("div");
    div.className="prompt-item"+(selectedPromptId===id?" selected":"");
    div.innerHTML=`<span>${p.name}</span>
      <div class="prompt-actions">
        <button onclick="editPrompt('${id}')">âœŽ</button>
        <button onclick="deletePrompt('${id}')">ðŸ—‘</button>
      </div>`;
    div.onclick=()=>loadPrompt(id);
    promptListEl.appendChild(div);
  }
}

function loadPrompt(id){
  const data=JSON.parse(localStorage.getItem("prompts")||"{}");
  const p=data[id];
  if(!p) return;
  selectedPromptId=id;
  fields.forEach(f=>document.getElementById(f).value=p[f]||"");
  nameInput.value=p.name;
  descInput.value=p.description||"";
  updatePreview();
  unsavedChanges=false;
  loadPrompts();
}

function savePrompt(){
  const name=nameInput.value.trim();
  if(!name){alert(i18n[langSwitch.value].nameRequired);return;}
  const data=JSON.parse(localStorage.getItem("prompts")||"{}");
  const id=selectedPromptId || "p"+Date.now();
  const obj={name, description: descInput.value.trim()};
  fields.forEach(f=>obj[f]=document.getElementById(f).value);
  data[id]=obj;
  localStorage.setItem("prompts", JSON.stringify(data));
  selectedPromptId=id;
  unsavedChanges=false;
  loadPrompts();
}

function deletePrompt(id){
  const data=JSON.parse(localStorage.getItem("prompts")||"{}");
  delete data[id];
  localStorage.setItem("prompts", JSON.stringify(data));
  if(selectedPromptId===id){selectedPromptId=null;fields.forEach(f=>document.getElementById(f).value="");nameInput.value="";descInput.value="";unsavedChanges=false;}
  loadPrompts();
}

function editPrompt(id){
  if(unsavedChanges){
    if(!confirm(i18n[langSwitch.value].unsavedConfirm)) return;
  }
  loadPrompt(id);
}

function newPrompt(){
  if(unsavedChanges){
    if(!confirm(i18n[langSwitch.value].unsavedConfirm)) return;
  }
  selectedPromptId=null;
  fields.forEach(f=>document.getElementById(f).value="");
  nameInput.value="";
  descInput.value="";
  updatePreview();
  unsavedChanges=false;
}

window.addEventListener("beforeunload",(e)=>{
  if(unsavedChanges){
    e.preventDefault();
    e.returnValue='';
  }
});

// Event listeners
fields.forEach(f=>document.getElementById(f).addEventListener("input", updatePreview));
document.getElementById("savePromptBtn").addEventListener("click", savePrompt);
newPromptBtn.addEventListener("click", newPrompt);

// Initialize
updatePreview();
loadPrompts();
</script>
</body>
</html>
